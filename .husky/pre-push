#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Pre-push Quality Check Pipeline
# This hook runs comprehensive checks before allowing code to be pushed

# 1. Code Style and Linting
echo "🔍 Running linting checks..."
yarn lint || { echo "❌ Linting failed. Please fix the errors before pushing."; exit 1; }

# 2. Code Formatting
echo "💅 Checking code formatting..."
yarn format || { echo "❌ Code formatting check failed. Run 'yarn format:fix' to fix issues."; exit 1; }

# 3. TypeScript Type Check
echo "📝 Running type check..."
yarn type-check || { echo "❌ Type check failed. Please fix type errors."; exit 1; }

# 4. Unit Tests
echo "🧪 Running Vitest unit tests..."
yarn test || { echo "❌ Unit tests failed. Please fix the failing tests."; exit 1; }

# 5. End-to-End Tests
echo "🚀 Running E2E tests..."
yarn test:e2e || { echo "❌ E2E tests failed. Please check the test report."; exit 1; }

# 6. Production Build
echo "📦 Creating production build..."
yarn build || { echo "❌ Build failed. Please fix build errors."; exit 1; }

echo "✅ All quality checks passed successfully!"
