#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Pre-push Quality Check Pipeline
# This hook runs comprehensive checks before allowing code to be pushed

# 1. Code Style and Linting
echo "ğŸ” Running linting checks..."
pnpm lint || { echo "âŒ Linting failed. Please fix the errors before pushing."; exit 1; }

# 2. Code Formatting
echo "ğŸ’… Checking code formatting..."
pnpm format || { echo "âŒ Code formatting check failed. Run 'pnpm format:fix' to fix issues."; exit 1; }

# 3. TypeScript Type Check
echo "ğŸ“ Running type check..."
pnpm type-check || { echo "âŒ Type check failed. Please fix type errors."; exit 1; }

# 4. Unit Tests
echo "ğŸ§ª Running Vitest unit tests..."
pnpm test || { echo "âŒ Unit tests failed. Please fix the failing tests."; exit 1; }

# 5. End-to-End Tests
echo "ğŸš€ Running E2E tests..."
pnpm test:e2e || { echo "âŒ E2E tests failed. Please check the test report."; exit 1; }

# 6. Production Build
echo "ğŸ“¦ Creating production build..."
pnpm build || { echo "âŒ Build failed. Please fix build errors."; exit 1; }

echo "âœ… All quality checks passed successfully!"
